<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Googleログインの実装</title>
    <!-- 1. Google Identity Services ライブラリを読み込む -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        body {
            background-color: #1a1a1a;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }

        /* ボタンを配置するコンテナ */
        #google_btn_container {
            width: fit-content;
        }
    </style>
</head>
<body>

    <!-- 2. Googleログインボタンを配置する場所 -->
    <div id="g_id_onload"
         data-client_id="YOUR_CLIENT_ID.apps.googleusercontent.com" 
         data-context="signin"
         data-ux_mode="popup"
         data-callback="handleCredentialResponse"
         data-auto_prompt="false">
    </div>

    <!-- 3. 本物のボタンを表示（画像に近いデザインに設定） -->
    <div class="g_id_signin"
         data-type="standard"
         data-shape="pill"
         data-theme="filled_black"
         data-text="continue_with"
         data-size="large"
         data-logo_alignment="left">
    </div>

    <script>
        // 4. ログイン成功時に実行される関数
        function handleCredentialResponse(response) {
            console.log("Encoded JWT ID token: " + response.credential);
            
            // ここでサーバーにトークンを送ったり、ユーザー情報をデコードしたりします
            const responsePayload = parseJwt(response.credential);
            alert(responsePayload.name + " さん、こんにちは！");
        }

        // JWTトークンを読み取るための簡易的な関数
        function parseJwt (token) {
            var base64Url = token.split('.')[1];
            var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            return JSON.parse(jsonPayload);
        };
    </script>
</body>
</html>
